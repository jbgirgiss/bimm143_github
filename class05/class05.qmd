---
title: "Class 5: Data Visualization with ggplot"
author: "Joseph Girgiss (A17388247)"
format: pdf
---

Today we are exploring the **ggplot** package and how to make nice figures in R. 

There are lots of ways to make figures and plots in R. These include: 

- so called "base" R
- and add on packages like **ggplot2**

Here is a simple "base" R plot. 

```{r}
head(cars)
```

We can simply pass this to the `plot()` function. 

```{r}
plot(cars)
```

> Key-point: Base R is quick but not so nice looking in some folks eyes. 

Let's see how we can plot this with **ggplot2**... 

First, I need to install this add-on package. For this we use the `install.packages()` function - **WE DO THIS IN THE CONSOLE, NOT our report**. This is a one time only deal. 

Second, we need to load the package with `library()` function every time we want to use it. 

Every ggplot is composed of at least three layers:

- data (i.e. a data.frame with the things you want to plot)
- aesthetics **aes()** that map the columns of data to your plot features (i.e. aesthetics)
- geom like **geom_point()** that srt how the plot appears. 


```{r}
library(ggplot2)
ggplot(cars) + 
  aes(x=speed, y = dist) + 
  geom_point()
```


> Key point: For simple "canned" graphs, base R is quicker but as things get more elaborate then ggplot wins out... 


Let's add more layers to our ggplot. 

Add a line showing the relationship between x and y. 
Add a title
Add custom axis labels "Speed (MPH)" and "Distance(ft)"
Change the theme... 


```{r}
ggplot(cars) + 
  aes(x=speed, y = dist) + 
  geom_point() + 
  geom_smooth(method="lm", se=FALSE) + 
  labs(title = "Silly plot of Speed vs Stopping distance") + 
  xlab("Speed (MPH)") + 
  ylab("Distance (ft)") + 
  theme_bw()
```

## Going further 

Read some gene expression data 

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

> Q1. How many genes are in this dataset?

```{r}
nrow(genes)
ncol(genes)
```

> Q2. How many "up" regulated genes are there? 

A useful function for counting up occurrences of things in a vector is the `table()` function. 

```{r}
table(genes$State)
```

```{r}
round( table(genes$State)/nrow(genes) * 100, 2)
```
Make a v1 figure

```{r}
p <- ggplot(genes) + 
  aes(x = Condition1, y = Condition2, col=State) + 
  geom_point()
```

```{r}
p + scale_color_manual( values=c("blue","gray","red") ) + 
  labs(title = "Gene Expression Changes Upon Drug Treatment") + 
  xlab("Control (no drug)") +
  ylab("Drug Treatment") + 
  theme_bw()
```

## More plotting examples

Read in the gapminder dataset

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

Let's look at the gapminder dataset. 

```{r}
head(gapminder, 3)
tail(gapminder, 3)
```

> Q4. How many different country values are in this dataset? 

```{r}
length(unique(gapminder$country))
```

> Q5. How many different continent values are in this dataset? 

```{r}
length(unique(gapminder$continent))
```
```{r}
unique(gapminder$continent)
```

Make a v1 plot:

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, size=pop, label=country) +
  geom_point(alpha = 0.5) + 
  theme_bw()
```


I can use the **ggrepel**package to make more sensible labels. 

```{r}
library(ggrepel)
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, size=pop, label=country) +
  geom_point(alpha = 0.5) + 
  geom_text_repel() + 
  theme_bw()
```

I want a separate pannel per continent. 

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col=continent, size=pop, label=continent) +
  geom_point(alpha = 0.5) + 
  facet_wrap(~continent) +
  theme_bw()
```

The main advantages of ggplot over base R: 

- Grammar‑of‑graphics framework makes complex visualizations easier to describe
- Layered construction lets you add, modify, or remove plot elements incrementally
- Automatic legends and scales handle aesthetic mappings without extra code
- Faceting creates multi‑panel (small‑multiple) plots with a single command
- Seamless integration with the tidyverse supports reproducible, pipe‑friendly workflows


